plugins {
  id("java")
  id("fabric-loom")
  id("base")
}

java {
  toolchain { languageVersion = JavaLanguageVersion.of(21) }
}

group = project.findProperty("maven_group")
version = project.findProperty("mod_version")

base {
  archivesName = project.findProperty("archives_base_name") as String
}

repositories {
  mavenCentral()
  maven { url = uri("https://maven.fabricmc.net/") }
}

dependencies {
  minecraft("com.mojang:minecraft:${project.findProperty("minecraft_version")}")
  mappings("net.fabricmc:yarn:${project.findProperty("yarn_mappings")}:v2")
  modImplementation("net.fabricmc:fabric-loader:${project.findProperty("loader_version")}")
  modImplementation("net.fabricmc.fabric-api:fabric-api:${project.findProperty("fabric_api_version")}")
}

loom { splitEnvironmentSourceSets() }

tasks.processResources {
  inputs.property("version", project.version)
  filesMatching("fabric.mod.json") { expand([version: project.version]) }
}
